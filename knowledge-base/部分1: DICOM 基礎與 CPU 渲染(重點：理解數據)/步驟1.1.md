# 步骤1.1: CT/MRI 成像概览；DICOM 核心概念

## 理论讲解

### 1. CT/MRI 成像技术是如何工作的？（高度概括）

想象一下，我们想看到人体内部的样子，但又不想真的把它切开。

- **CT (Computed Tomography - 计算机断层扫描)**:

  - **原理**: 像是在“切萝卜”。CT 机有一个会旋转的 X 光发射器和接收器。它围绕你的身体转圈，从成百上千个不同角度发射 X 光并记录穿透你身体后的强度。
  - **产出**: 计算机接收到这些数据后，通过复杂的数学算法（比如`傅里叶变换`）重建出身体横截面的图像。每一张图像都像是一个极薄的“切片”。这些切片的像素值代表了人体组织的**密度**。骨头最密，X 光最难穿透，所以最亮；空气最稀疏，最容易穿透，所以最暗。这个密度值被称为**亨斯菲尔德单位 (Hounsfield Unit, HU)**。

- **MRI (Magnetic Resonance Imaging - 磁共振成像)**:
  - **原理**: 这次不是用 X 光，而是利用强大的磁场和无线电波。简单说，它让体内的氢原子（主要是水分子里的）“排好队”，然后用无线电波去“拨动”它们，再听它们恢复原位时发出的“回声”。
  - **产出**: 不同组织（如肌肉、脂肪、大脑灰质/白质）里的氢原子“回声”特性不同。计算机根据这些信号差异，就能描绘出不同软组织的精细图像。MRI 对软组织的区分能力远超 CT。

**关键 takeaway**: 无论是 CT 还是 MRI，它们最终都为我们提供了一系列二维的“切片”图像，这些切片按顺序堆叠起来，就构成了我们身体某一部位的三维结构。

### 2. 什么是 DICOM？

如果每个 CT、MRI 厂家都用自己的格式存图片，那医院里的系统就乱套了。A 厂家的设备拍的片子，B 厂家的软件打不开，这就没法诊断了。

**DICOM (Digital Imaging and Communications in Medicine)** 就是为了解决这个问题而生的国际标准。它规定了医学影像的**文件格式**和**网络通信协议**。

你可以把一个 `.dcm` 文件想象成一个“超级图片”，它不仅包含了像素数据（图像本身），还捆绑了大量的**元数据 (Metadata)**。

### 3. DICOM 核心概念

一个 DICOM 文件内部就像一个结构化的“字典”，由很多“键值对”组成。

- **Tag (标签)**:

  - 这是每个数据元素的唯一标识符，格式通常是 `(gggg, eeee)`，其中 `g` 是组号，`e` 是元素号。例如 `(0028, 0010)` 这个 Tag 就代表“行数 (Rows)”。
  - 你不需要去记这些数字，通常我们会用更易读的名字来代指它们，比如 `Rows`。

- **VR (Value Representation - 值表示)**:

  - 它定义了这个 Tag 对应的值是什么数据类型。比如：
    - `US`: Unsigned Short (无符号短整型)
    - `DS`: Decimal String (十进制字符串)
    - `PN`: Person Name (人名)
    - `OW`: Other Word (其他字，通常用于像素数据)
  - 有了 VR，解析程序才知道该如何正确读取和解释这个 Tag 的值。

- **Pixel Data (像素数据) - `(7FE0, 0010)`**:

  - 这是最重要的 Tag，它存储了真正的图像数据。这部分数据通常是二进制的原始像素值（比如 CT 的 HU 值），是一个长长的一维数组。
  - 我们需要结合其他 Tag，如 `Rows (0028, 0010)`、`Columns (0028, 0011)`、`Bits Stored (0028, 0101)` 等，才能正确地把这个一维数组还原成二维图像。

- **显示链路 (Display Pipeline)**:
  - 从 `Pixel Data` 里的原始值（例如 -1000 HU）到我们在屏幕上看到的灰度颜色（例如 RGB 值 `(50, 50, 50)`），中间需要一个转换过程。这个过程就是显示链路。
  - 后续我们会详细讲解，它主要涉及两个关键步骤：
    1.  **值调整 (Value of Interest, VOI)**: 主要通过**窗宽/窗位 (Window Width / Window Level)** 来进行。
    2.  **颜色映射 (Presentation)**: 将调整后的值映射成屏幕能显示的颜色。
