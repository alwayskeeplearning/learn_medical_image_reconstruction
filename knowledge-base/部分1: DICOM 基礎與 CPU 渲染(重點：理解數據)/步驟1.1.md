# 步驟1.1: CT/MRI 成像概覽；DICOM 核心概念

## 理論講解

### 1. CT/MRI 成像技術是如何工作的？（高度概括）

想像一下，我們想看到人體內部的樣子，但又不想真的把它切開。

- **CT (Computed Tomography - 計算機斷層掃描)**:

  - **原理**: 像是在「切蘿蔔」。CT 機有一個會旋轉的 X 光發射器和接收器。它圍繞你的身體轉圈，從成百上千個不同角度發射 X 光並記錄穿透你身體後的強度。
  - **產出**: 計算機接收到這些數據後，通過複雜的數學算法（比如`傅里葉變換`）重建出身體橫截面的圖像。每一張圖像都像是一個極薄的「切片」。這些切片的像素值代表了人體組織的**密度**。骨頭最密，X 光最難穿透，所以最亮；空氣最稀疏，最容易穿透，所以最暗。這個密度值被稱為**亨斯菲爾德單位 (Hounsfield Unit, HU)**。

- **MRI (Magnetic Resonance Imaging - 磁共振成像)**:
  - **原理**: 這次不是用 X 光，而是利用強大的磁場和無線電波。簡單說，它讓體內的氫原子（主要是水分子裡的）「排好隊」，然後用無線電波去「撥動」它們，再聽它們恢復原位時發出的「回聲」。
  - **產出**: 不同組織（如肌肉、脂肪、大腦灰質/白質）裡的氫原子「回聲」特性不同。計算機根據這些信號差異，就能描繪出不同軟組織的精細圖像。MRI 對軟組織的區分能力遠超 CT。

**關鍵 takeaway**: 無論是 CT 還是 MRI，它們最終都為我們提供了一系列二維的「切片」圖像，這些切片按順序堆疊起來，就構成了我們身體某一部位的三維結構。

### 2. 什麼是 DICOM？

如果每個 CT、MRI 廠家都用自己的格式存圖片，那醫院裡的系統就亂套了。A 廠家的設備拍的片子，B 廠家的軟件打不開，這就沒法診斷了。

**DICOM (Digital Imaging and Communications in Medicine)** 就是為了解決這個問題而生的國際標準。它規定了醫學影像的**文件格式**和**網絡通信協議**。

你可以把一個 `.dcm` 文件想像成一個「超級圖片」，它不僅包含了像素數據（圖像本身），還捆綁了大量的**元數據 (Metadata)**。

### 3. DICOM 核心概念

一個 DICOM 文件內部就像一個結構化的「字典」，由很多「鍵值對」組成。

- **Tag (標籤)**:

  - 這是每個數據元素的唯一標識符，格式通常是 `(gggg, eeee)`，其中 `g` 是組號，`e` 是元素號。例如 `(0028, 0010)` 這個 Tag 就代表「行數 (Rows)」。
  - 你不需要去記這些數字，通常我們會用更易讀的名字來代指它們，比如 `Rows`。

- **VR (Value Representation - 值表示)**:

  - 它定義了這個 Tag 對應的值是什麼數據類型。比如：
    - `US`: Unsigned Short (無符號短整型)
    - `DS`: Decimal String (十進制字符串)
    - `PN`: Person Name (人名)
    - `OW`: Other Word (其他字，通常用於像素數據)
  - 有了 VR，解析程序才知道該如何正確讀取和解釋這個 Tag 的值。

- **Pixel Data (像素數據) - `(7FE0, 0010)`**:

  - 這是最重要的 Tag，它存儲了真正的圖像數據。這部分數據通常是二進制的原始像素值（比如 CT 的 HU 值），是一個長長的一維數組。
  - 我們需要結合其他 Tag，如 `Rows (0028, 0010)`、`Columns (0028, 0011)`、`Bits Stored (0028, 0101)` 等，才能正確地把這個一維數組還原成二維圖像。

- **顯示鏈路 (Display Pipeline)**:
  - 從 `Pixel Data` 裡的原始值（例如 -1000 HU）到我們在屏幕上看到的灰度顏色（例如 RGB 值 `(50, 50, 50)`），中間需要一個轉換過程。這個過程就是顯示鏈路。
  - 後續我們會詳細講解，它主要涉及兩個關鍵步驟：
    1.  **值調整 (Value of Interest, VOI)**: 主要通過**窗寬/窗位 (Window Width / Window Level)** 來進行。
    2.  **顏色映射 (Presentation)**: 將調整後的值映射成屏幕能顯示的顏色。
